{% extends 'base.html.twig' %}

{% block title %}{{ 'title.admin_panel'|trans }}{% endblock %}

{% block body %}
<h1>{{ 'title.admin_panel'|trans }}</h1>

<div class="accordion" id="adminAccordion">

    <!-- Posty -->
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingPosts">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePosts" aria-expanded="false" aria-controls="collapsePosts">
                {{ 'label.posts'|trans }}
            </button>
        </h2>
        <div id="collapsePosts" class="accordion-collapse collapse" aria-labelledby="headingPosts" data-bs-parent="#adminAccordion">
            <div class="accordion-body">
                <a href="{{ path('post_new') }}" class="btn btn-success mb-3">{{ 'button.add_post'|trans }}</a>
                <ul class="list-group">
                    {% for post in posts %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ post.title }}
                            <div>
                                <a href="{{ path('post_edit', {'id': post.id}) }}" class="btn btn-primary btn-sm">{{ 'button.edit'|trans }}</a>
                                <form method="post" action="{{ path('post_delete', {'id': post.id}) }}" style="display:inline-block" onsubmit="return confirm('{{ 'message.confirm_delete_post'|trans }}');">
                                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                                    <button class="btn btn-danger btn-sm">{{ 'button.delete'|trans }}</button>
                                </form>
                            </div>
                        </li>
                    {% else %}
                        <li class="list-group-item">{{ 'message.no_posts'|trans }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Kategorie -->
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingCategories">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCategories" aria-expanded="false" aria-controls="collapseCategories">
                {{ 'label.categories'|trans }}
            </button>
        </h2>
        <div id="collapseCategories" class="accordion-collapse collapse" aria-labelledby="headingCategories" data-bs-parent="#adminAccordion">
            <div class="accordion-body">
                <a href="{{ path('categories_new') }}" class="btn btn-success mb-3">{{ 'button.add_category'|trans }}</a>
                <ul class="list-group">
                    {% for category in categories %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>{{ category.name }}</span>
                            <div class="d-flex gap-2">
                                <a href="{{ path('categories_edit', {'id': category.id}) }}" class="btn btn-primary btn-sm">{{ 'button.edit'|trans }}</a>
                                <form method="post" action="{{ path('categories_delete', {'id': category.id}) }}" style="margin:0;" onsubmit="return confirm('{{ 'message.confirm_delete_category'|trans }}');">
                                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ category.id) }}">
                                    <button class="btn btn-danger btn-sm">{{ 'button.delete'|trans }}</button>
                                </form>
                            </div>
                        </li>
                    {% else %}
                        <li class="list-group-item">{{ 'message.no_categories'|trans }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Komentarze -->
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingComments">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseComments" aria-expanded="false" aria-controls="collapseComments">
                {{ 'label.comments'|trans }}
            </button>
        </h2>
        <div id="collapseComments" class="accordion-collapse collapse" aria-labelledby="headingComments" data-bs-parent="#adminAccordion">
            <div class="accordion-body">
                <ul class="list-group">
                    {% for comment in comments %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ comment.nickname }}</strong> {{ 'text.in_post'|trans }} <em>{{ comment.post.title }}</em> â€” 
                                {{ comment.content|length > 50 ? comment.content|slice(0, 50) ~ '...' : comment.content }}
                            </div>
                            <form method="post" action="{{ path('comment_delete', {'id': comment.id}) }}" style="display:inline-block" onsubmit="return confirm('{{ 'message.confirm_delete_comment'|trans }}');">
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ comment.id) }}">
                                <button class="btn btn-danger btn-sm">{{ 'button.delete'|trans }}</button>
                            </form>
                        </li>
                    {% else %}
                        <li class="list-group-item">{{ 'message.no_comments'|trans }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

</div>
{% endblock %}
